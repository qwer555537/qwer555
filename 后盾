from flask import Flask, request, jsonify
from flask_cors import CORS
import random
import time

app = Flask(__name__)
CORS(app, resources={
    r"/api/*": {
        "origins": "*",
        "methods": ["POST", "OPTIONS"],
        "allow_headers": ["Content-Type"]
    }
})

# é¢„è®¾çš„å›å¤æ¨¡æ¿
RESPONSES = [
    "å“ˆå“ˆå“ˆï¼Œä½ è¯´å¾—å¯¹ï¼ğŸ˜†",
    "å•Šï¼Ÿæˆ‘åˆšæ‰åœ¨å‘å‘†ï¼Œæ²¡å¬æ¸…...ğŸ˜…",
    "è¿™ä¸ªå˜›...è®©æˆ‘æƒ³æƒ³...ğŸ¤”",
    "æˆ‘è§‰å¾—å¯ä»¥å»åƒç«é”…ï¼ğŸ²",
    "ä½ è¯´ä»€ä¹ˆéƒ½å¯¹ï¼æˆ‘å…ˆå»ç¡è§‰äº†...ğŸ˜´",
    "è¿™ä¸ªé—®é¢˜å¤ªéš¾äº†ï¼Œæˆ‘è¦å»é—®é—®æˆ‘çš„çŒ«å’ª...ğŸ±",
    "æˆ‘åˆšæ‰åœ¨æƒ³ä¸€ä¸ªç‰¹åˆ«å¥½ç¬‘çš„äº‹æƒ…...ğŸ˜‚",
    "è¦ä¸æˆ‘ä»¬å»è·³èˆå§ï¼ğŸ’ƒ",
    "è¿™ä¸ªé—®é¢˜å˜›...ï¼ˆå¼€å§‹å‚»ç¬‘ï¼‰ğŸ˜"
]

@app.route('/api/chat', methods=['POST'])
def chat():
    try:
        data = request.json
        user_message = data.get('message', '')
        
        if not user_message:
            return jsonify({"error": "æ¶ˆæ¯ä¸èƒ½ä¸ºç©º"}), 400

        # éšæœºé€‰æ‹©ä¸€ä¸ªå›å¤
        response = random.choice(RESPONSES)
        
        # æ·»åŠ ä¸€ç‚¹å»¶è¿Ÿï¼Œæ¨¡æ‹Ÿæ€è€ƒæ—¶é—´
        time.sleep(0.3)
        
        return jsonify({"response": response})

    except Exception as e:
        return jsonify({"error": "æœåŠ¡å™¨é‡åˆ°äº†é—®é¢˜"}), 500

if __name__ == '__main__':
    app.run(port=5000, debug=True)
